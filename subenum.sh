#!/bin/sh

###############################################
##
## Description:  Enumeration and Print of IP Adresses in certain Subnet
## -net defines the Network ID -start and -end  Defines the IP-Range
## Example Usage: scanRange --net=192.168.1 --start=5 --end=240 -> Will scan the IP-Range 192.168.1.5 to 192.168.1.240
##
###############################################

## Enumerate Options
   
for arg in "$@"; do
     if [ $(echo $arg | grep -e "--net") ]; then IPNETWORK=$(echo $arg | cut -d "=" -f 2); echo; fi
     if [ $(echo $arg | grep -e "--start") ]; then RANGESTART=$(echo $arg | cut -d "=" -f 2); echo $RANGESTART; fi
     if [ $(echo $arg | grep -e "--end") ]; then RANGEEND=$(echo $arg | cut -d "=" -f 2); echo $RANGEEND; fi
     if [ $(echo $arg | grep -e "-G") ]; then GREPABLE=$(echo $arg | cut -d "=" -f 2); echo $GREPABLE; fi
done



scanRange()
{
  
  AUID=$(id -u)	
  echo "Actual UIDÂ = $UID"
  
  if [ ! "$AUID" = 0 ]; then
	  echo "You have to run this script with UID 0"
	  echo "Aborting .."
	  exit
  fi

  for ip in $(seq $RANGESTART $RANGEEND); do
	  FULLIP=$IPNETWORK.$ip

	 # echo "Scanning IP $FULLIP .."
	  fping $FULLIP >/dev/null 2>&1

	  if [ -z $GREPABLE ]; then
	  	if [ $? = 0 ]; then
		     echo "$FULLIP responded to your Ping!"
		else
		     echo "$FULLIP didn't respond, or refuses ICMPv4 packets.."
  	 	fi
	  else	
	  	if [ $? = 0 ]; then
		     echo "$FULLIP | UP"
		else
		     echo "$FULLIP | DOWN"
	 	fi
	  fi
	  
  done

}

scanRange $IPNETWORK $RANGESTART $RANGEEND
