#!/bin/sh

VMNAME="kali"
HOSTNAME="kali"
USERNAME="h3105"
VPNPATH="/home/h3105/OS-69910-PWK.ovpn"

if [ ! -z "$@" ]; then VMNAME=$1; fi
if [ ! -z "$2" ]; then HOSTNAME=$2; fi
if [ ! -z "$2" ]; then USERNAME=$3; fi

KALIRUNNING=$(vboxmanage list runningvms)
echo $KALIRUNNING | grep $VMNAME
if [ ! "$?" = 0 ]; then
    echo "$VMNAME not Running.."
    exit 1
else
    ssh -T $USERNAME@$HOSTNAME "sudo openvpn $VPNPATH"
fi
